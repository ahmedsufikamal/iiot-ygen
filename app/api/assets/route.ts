import { store } from '@/lib/store'; export const runtime='nodejs'; export const dynamic='force-dynamic'; export async function GET(){ const devices = store.listDevices(); return Response.json({ devices }); } export async function POST(req:Request){ const body=await req.json().catch(()=>({})); const { name, equipmentType, hospitalId, model } = body||{}; if(!name || !equipmentType || !hospitalId) return Response.json({error:'name, equipmentType, hospitalId required'},{status:400}); const d=store.addDevice({name,equipmentType,hospitalId,model}); return Response.json({ ok:true, device:d }); } export async function DELETE(req:Request){ const url=new URL(req.url); const id=url.searchParams.get('id'); if(!id) return Response.json({error:'id required'},{status:400}); const ok=store.removeDevice(id); return Response.json({ ok }); }
