import { cookies } from 'next/headers'; import { getProfile, setProfile } from '@/lib/profile-store'; export const runtime='nodejs'; export const dynamic='force-dynamic'; export async function GET(){ const c=cookies(); const email=c.get('email')?.value||null; const p=getProfile(email||undefined); return Response.json({ ok:true, profile: { email, ...p } }); } export async function POST(req:Request){ const c=cookies(); const email=c.get('email')?.value||null; const body=await req.json().catch(()=>({})); const p=setProfile(email||undefined, { avatarUrl: body.avatarUrl, email }); return Response.json({ ok:true, profile:p }); }
